<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add User | E-Office Management</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body, html {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #f8f9fa;
    }

    .header {
      height: 70px;
      background-color: #fff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 25px;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 999;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .sidebar {
      width: 220px;
      background: #343a40;
      color: white;
      height: 100vh;
      position: fixed;
      top: 70px;
      left: 0;
      padding-top: 20px;
    }

    .sidebar .nav-link {
      color: #adb5bd;
      padding: 12px 20px;
      display: flex;
      align-items: center;
    }

    .sidebar .nav-link i {
      margin-right: 10px;
      font-size: 1.2rem;
    }

    .sidebar .nav-link:hover, .sidebar .nav-link.active {
      background: #495057;
      color: white;
    }

    .main-content {
      margin-left: 220px;
      margin-top: 90px;
      padding: 30px;
    }

    .form-section {
      background: #fff;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .form-title {
      margin-bottom: 25px;
      font-weight: 600;
      font-size: 1.3rem;
    }

    .language-selector {
      width: 200px;
    }

    .table td, .table th {
      vertical-align: middle;
    }

    .modal-header {
      background: #343a40;
      color: white;
    }

    @media (max-width: 768px) {
      .main-content {
        margin-left: 0;
        padding: 20px;
      }
      .sidebar {
        display: none;
      }
    }
  </style>
</head>
<body>

<!-- Header -->
<div class="header">
  <div class="d-flex align-items-center">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQYiFdEW56wVH-LUuoUp7CmFzybzsFrSKDAOg&s" height="50" class="me-2" />
    <h5 class="mb-0" data-translate="dashboardTitle">E-Office Management</h5>
  </div>
  <div class="d-flex align-items-center gap-3">
    <select id="languageSelect" class="form-select form-select-sm">
      <option value="en">English</option>
      <option value="hi">हिन्दी</option>
      <option value="mr">मराठी</option>
    </select>
    <div class="dropdown">
      <i class="bi bi-person-circle fs-3" data-bs-toggle="dropdown" style="cursor: pointer;"></i>
      <ul class="dropdown-menu dropdown-menu-end">
        <!-- <li><a class="dropdown-item" href="#">Profile</a></li> -->
        <li><a class="dropdown-item" href="#" id="logoutBtn">Logout</a></li>
      </ul>
    </div>
  </div>
</div>

<!-- Sidebar -->
<div class="sidebar">
  <a href="dashboard.html" class="nav-link d-flex align-items-center">
    <i class="bi bi-house-door-fill me-2 fs-5"></i> 
    <span data-translate="dashboard">Dashboard</span>
  </a>
  <a href="adduser.html" class="nav-link d-flex align-items-center active">
    <i class="bi bi-person-plus-fill me-2 fs-5"></i> 
    <span data-translate="addUser">Add User</span>
  </a>
  <a href="applicationform.html" class="nav-link d-flex align-items-center">
    <i class="bi bi-folder-fill me-2 fs-5"></i> 
    <span data-translate="applicationForm">Application Form</span>
  </a>
  <a href="applications.html" class="nav-link d-flex align-items-center">
    <i class="bi bi-file-earmark-text me-2 fs-5"></i> 
    <span data-translate="applications">Applications</span>
  </a>
</div>

<!-- Main Content -->
<div class="main-content">
  <div class="form-section">
    <div class="form-title" data-translate="add_new_user">Add New User</div>
    <form>
      <div class="mb-3">
        <label for="userName" class="form-label" data-translate="name">Name</label>
        <input type="text" class="form-control" id="userName" required>
      </div>
      <div class="mb-3">
        <label for="userRole" class="form-label" data-translate="role">Role</label>
        <select class="form-select" id="userRole" required>
          <option value="" disabled selected data-translate="select_role">Select Role</option>
          <option data-translate="minister">Minister</option>
          <option data-translate="ps_minister">P.S to Minister</option>
          <option data-translate="osd">OSD</option>
          <option data-translate="manoj_wadgaonkar">Manoj Wadgaonkar</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="userMobile" class="form-label" data-translate="mobile_number">Mobile Number</label>
        <input type="tel" class="form-control" id="userMobile" pattern="[0-9]{10}" required>
      </div>
      <button type="submit" class="btn btn-primary" data-translate="add_user">Add User</button>
    </form>
  </div>

  <div class="form-section mt-4">
    <h6 data-translate="user_logs_activity">User Logs & Activity</h6>
    <table class="table table-bordered mt-3">
      <thead>
        <tr>
          <th data-translate="name">Name</th>
          <th data-translate="role">Role</th>
          <th data-translate="mobile">Mobile</th>
          <th data-translate="last_login">Last Login</th>
          <th data-translate="last_logout">Last Logout</th>
          <th data-translate="logs">Logs</th>
          <th data-translate="actions">Actions</th>
        </tr>
      </thead>
      <tbody id="userTable">
        <tr>
          <td>John Doe</td>
          <td data-translate="minister">Minister</td>
          <td>9876543210</td>
          <td>2025-04-22 09:00 AM</td>
          <td>2025-04-22 06:00 PM</td>
          <td data-translate="viewed_dashboard_added_application">Viewed Dashboard, Added Application</td>
          <td>
            <button class="btn btn-sm btn-warning" onclick="showPinModal('edit')" title="Edit"><i class="bi bi-pencil"></i></button>
            <button class="btn btn-sm btn-danger" onclick="showPinModal('delete')" title="Delete"><i class="bi bi-trash"></i></button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- PIN Modal -->
<div class="modal fade" id="pinModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <form class="modal-content" id="pinForm">
      <div class="modal-header">
        <h5 class="modal-title" data-translate="enter_pin">Enter 4-Digit PIN</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <input type="password" class="form-control text-center" id="pinInput" maxlength="4" placeholder="••••" required>
        <small class="text-muted" data-translate="pin_note">PIN required to proceed with edit/delete.</small>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary" data-translate="confirm">Confirm</button>
      </div>
    </form>
  </div>
</div>

<!-- Edit Modal -->
<div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <form class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" data-translate="edit_user">Edit User</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label for="editName" class="form-label" data-translate="name">Name</label>
          <input type="text" class="form-control" id="editName">
        </div>
        <div class="mb-3">
          <label for="editRole" class="form-label" data-translate="role">Role</label>
          <select class="form-select" id="editRole">
            <option data-translate="minister">Minister</option>
            <option data-translate="ps_minister">P.S to Minister</option>
            <option data-translate="osd">OSD</option>
            <option data-translate="manoj_wadgaonkar">Manoj Wadgaonkar</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="editMobile" class="form-label" data-translate="mobile_number">Mobile Number</label>
          <input type="text" class="form-control" id="editMobile" maxlength="10">
        </div>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-success" data-translate="save_changes">Save Changes</button>
      </div>
    </form>
  </div>
</div>

  
  

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  

  document.addEventListener("DOMContentLoaded", function () {
    const languageSelect = document.getElementById("languageSelect");
    const currentLang = localStorage.getItem("lang") || "en";

    if (languageSelect) {
      languageSelect.value = currentLang;
      languageSelect.addEventListener("change", function () {
        const lang = this.value;
        localStorage.setItem("lang", lang);
        applyLanguage(lang);
      });
    }

    applyLanguage(currentLang);
  });

  
</script>
<script>
    let selectedAction = "";
    let selectedUserIndex = null;
  
    // Load users from localStorage and render the table
    function loadUsers() {
      const users = JSON.parse(localStorage.getItem("users")) || [];
      const userTable = document.getElementById("userTable");
      userTable.innerHTML = "";
  
      users.forEach((user, index) => {
        const row = `
          <tr>
            <td>${user.name}</td>
            <td>${user.role}</td>
            <td>${user.mobile}</td>
            <td>${user.lastLogin || "-"}</td>
            <td>${user.lastLogout || "-"}</td>
            <td>${user.logs || "-"}</td>
            <td>
              <button class="btn btn-sm btn-warning" onclick="showPinModal('edit', ${index})"><i class="bi bi-pencil"></i></button>
              <button class="btn btn-sm btn-danger" onclick="showPinModal('delete', ${index})"><i class="bi bi-trash"></i></button>
            </td>
          </tr>
        `;
        userTable.insertAdjacentHTML("beforeend", row);
      });
    }
  
    // Save user from form
    document.querySelector("form").addEventListener("submit", function (e) {
      e.preventDefault();
      const name = document.getElementById("userName").value;
      const role = document.getElementById("userRole").value;
      const mobile = document.getElementById("userMobile").value;
  
      const users = JSON.parse(localStorage.getItem("users")) || [];
      users.push({ name, role, mobile, lastLogin: "-", lastLogout: "-", logs: "-" });
      localStorage.setItem("users", JSON.stringify(users));
  
      e.target.reset();
      loadUsers();
    });
  
    function showPinModal(action, index) {
      selectedAction = action;
      selectedUserIndex = index;
      document.getElementById("pinInput").value = "";
      new bootstrap.Modal(document.getElementById("pinModal")).show();
    }
  
    document.getElementById("pinForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const pin = document.getElementById("pinInput").value;
      const users = JSON.parse(localStorage.getItem("users")) || [];
  
      if (pin === "9098") {
        bootstrap.Modal.getInstance(document.getElementById("pinModal")).hide();
  
        if (selectedAction === "edit") {
          const user = users[selectedUserIndex];
          document.getElementById("editName").value = user.name;
          document.getElementById("editRole").value = user.role;
          document.getElementById("editMobile").value = user.mobile;
          new bootstrap.Modal(document.getElementById("editModal")).show();
        } else if (selectedAction === "delete") {
          users.splice(selectedUserIndex, 1);
          localStorage.setItem("users", JSON.stringify(users));
          loadUsers();
          alert("User deleted successfully!");
        }
      } else {
        alert("Incorrect PIN!");
      }
    });
  
    // Save edited user
    document.querySelector("#editModal form").addEventListener("submit", function (e) {
      e.preventDefault();
      const users = JSON.parse(localStorage.getItem("users")) || [];
  
      users[selectedUserIndex] = {
        ...users[selectedUserIndex],
        name: document.getElementById("editName").value,
        role: document.getElementById("editRole").value,
        mobile: document.getElementById("editMobile").value
      };
  
      localStorage.setItem("users", JSON.stringify(users));
      bootstrap.Modal.getInstance(document.getElementById("editModal")).hide();
      loadUsers();
      alert("User updated successfully!");
    });
  
    // Load users on page load
    document.addEventListener("DOMContentLoaded", loadUsers);
  </script>
  
  
<script src="Assets/Language/i18n.js"></script>
<script>
  // Redirect to login if user is not logged in
  if (!localStorage.getItem("user")) {
    window.location.href = "index.html";
  }

  // Disable back button after logout
  window.history.pushState(null, "", window.location.href);
  window.onpopstate = function () {
    window.history.pushState(null, "", window.location.href);
  };
</script>

<script>
  document.getElementById("logoutBtn").addEventListener("click", function (e) {
    e.preventDefault();

    // Clear any session/local storage if needed
    localStorage.clear();
    sessionStorage.clear();

    // Redirect to login page
    window.location.href = "index.html"; // Replace with your actual login page
  });
</script>
</body>
</html>
